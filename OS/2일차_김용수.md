## Chapter3. 03. 프로세스의 이해
- 프로세스는 실행중인 프로그램
- 프로세스는 운영체제의 일의 단위라고 보면 됨
- 프로세스는 수행을 위해 특정 자원이 필요함
  - cpu time
  - 메모리
  - 파일들
  - I/O 장치
- OS의 가장 기본적인 일은 프로세스를 관리하는 것
- 프로세스 메모리 구조는 몇개의 부분으로 나뉘어짐 
  - 텍스트 section(실행 코드)
  - 데이터 section(전역 변수)
  - 힙 section(동적 할당)
  - 스택 section(함수 파라미터, 반환 주소, 지역 변수등 저장)
- 프로세스는 5개의 라이프 사이클 상태가 존재 
  - New : 이제 막 프로세스가 생성된 상태
  - Running : 프로세스가 실행중인 상태
  - Waiting : 어떤 일이 발생하길 기다리고 있는 상태(ex. I/O 처리가 완료되길 기다림)
  - Ready : 실행되길 기다리고 있는 상태
  - Terminated : 종료
- New 상태에서 승인이 되면 ready 상태가 됨
- ready 상태에서 스케쥴러에 의해 디스패치되면 running 상태가 됨
- running 상태에서 i/o 이벤트가 발생하면 waiting, interrupt가 발생하면 ready, 끝나면 terminated상태가 됨
- waiting 상태에서 i/o 이벤트가 처리가 완료되면 다시 ready 상태가 됨
- 프로세스를 관리하기 위해서 PCB(Process Control Block)를 만들어서 관리
  - PCB는 각각의 프로세스가 가져야할 정보를 모두 가지고 있음
  - 프로세스 상태, 프로그램 카운터(다음에 수행할 명령어를 저장해두는 레지스터), CPU 레지스터, CPU 스케쥴링 정보, 메모리 관리 정보, 자원 오픈 정보 등 저장
- N개의 프로세스가 돌고있다면 N개의 PCB가 생성됨
- 프로세스는 싱글 쓰레드로 동작하는게 기본적인 구조임
- 싱글 쓰레드의 경우 하나의 업무만 한번에 처리 가능
- 그렇기에 멀티 테스킹과 멀티 쓰레딩이 필요함
- 한개의 프로세스에서도 여러개의 쓰레드로 수행되는 것이 필요함
- 쓰레드는 가벼운 프로세스라고 보면 됨
- 멀티 프로그래밍의 목적은 동시에 여러개의 프로세스를 수행시키는 것
  - CPU 사용률을 최대화 시키기 위해서
- 타임 쉐어링은 아주 작은 단위로 CPU 사용 시간을 쪼개서 동시에 처리하는 것처럼 보이게 하는 것
- 스케쥴링 큐
  - Ready Queue : 준비 상태인 프로세스들의 목록을 넣어둔 Queue
  - Waiting Queue : I/O를 기다리고 있는 목록을 넣어둔 Queue, Device가 여러개이기때문에 waiting 큐는 여러개
- 큐는 링크드 리스트로 구현해주면 됨
- CPU를 할당 받은 프로세스가 다시 Ready Queue로 돌아가는 경우
  - I/O 요청을 받고 처리가 완료된 경우
  - CPU 타임을 모두 사용한 경우
  - fork한 child가 실행이 완료된 경우
  - 인터럽트가 발생한 경우
- 실행중인 프로세스가 다른 프로세스로 전환이 일어날 때 Context Switch가 발생함
  - 현재 진행중인 프로세스의 상태를 저장하여 다음에 다시 그 부분부터 실행할 수 있도록 하며, 새로운 프로세스의 PCB를 복원함
- 운영체제는 프로세스를 생성하고 프로세스를 제거할 수 있어야함
- 프로세스는 여러 새 프로세스를 생성하며, 다른 프로세스를 생성하는 프로세스를 부모 프로세스, 생성당하는 프로세스를 자식 프로세스라고 부름
- 프로세스의 최상단에 init 프로세스(프로세스 번호 : 1)이 존재함
- 부모 프로세스는 일부 또는 모든 자식 프로세스가 종료될 때까지 wait함
- 부모와 같은 일을 하는 프로세스는 부모 프로세스의 주소공간을 그대로 복제함, 새로 할당할수도 있음
- 프로세스는 마지막 문장을 수행하거나 exit() 시스템 콜을 호출 시에 종료되며 OS는 메모리 등 자원을 회수함
- 부모 프로세스가 fork를 한 후에 wait를 안하고 끝나버리면 고아 프로세스가 되며, 부모 프로세스가 끝나진 않았는데 wait하지 않으면 자식 프로세스는 종료되면서 회수해갈 프로세스가 없어서 좀비 프로세스가 됨